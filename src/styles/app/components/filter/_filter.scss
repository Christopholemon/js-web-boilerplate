$filter-border: rem(1) solid rgba(c(gray d8d8d8), 0.5);
$filter-border-color-on-dark: rgba(c(white), 0.2);
$filter-dropdown__modal-heading-height: get($navigation-heights, 0);

.g-filter-dropdown-open {
  @include mq(767px, max-width) {
    overflow-y: hidden;

    &.browser-ios {
      body {
        position: fixed; //prevent rubber band scrolling at top and bottom
      }
    }
  }
}

.filter {
  position: relative;
  z-index: z(primary filter);

  .l-content {
    z-index: auto; // TODO: Hmmmm. Refactor?
  }
}

.filter__wrapper {
  display: flex;
  flex-wrap: wrap;

  .filter--center & {
    justify-content: center;
    min-height: rem(42); // to stop the jenky load on draw-overview
  }
}

.filter__wrapper--has-border {
  border: $filter-border;
}

.filter-dropdown {
  border-bottom: $filter-border;
  display: flex;
  position: relative;
  width: 100%;

  &:last-child:not(.filter-dropdown--combo) {
    border-bottom: none;
  }

  @include mq(768px) {
    border-bottom: none;
    border-right: $filter-border;
    width: auto;
  }

  .filter--center & {
    width: auto;
  }

  .filter__wrapper--on-dark & {
    border-color: $filter-border-color-on-dark;
  }

  .filter__wrapper--no-border & {
    border: none;
  }
}

.filter-dropdown--50-until-768 {
  border-bottom: none;
  border-right: $filter-border;
  width: 50%;

  @include mq(767px, max-width) {
    flex-grow: 1;
  }

  &:last-child {
    border-right: none;
  }

  @include mq(768px) {
    width: auto;

    &:last-child {
      border-right: $filter-border;

      .filter__wrapper--on-dark & {
        border-color: $filter-border-color-on-dark;
      }
    }
  }
}

.filter-dropdown--100-until-360 {
  @include mq(359px, max-width) {
    border-bottom: $filter-border;
    border-right: none;
    width: 100%;
  }
}

.filter-dropdown--combo {
  background-color: c(white);
  border: $filter-border;
  display: inline-flex;
  font-size: fs(14);
  width: auto;
}

.filter-dropdown__heading {
  align-items: center;
  color: c(white);
  display: flex;
  flex-grow: 1;
  font-size: fs(14);
  font-weight: fw(400);
  height: $filter-dropdown__modal-heading-height;
  left: 0;
  letter-spacing: rem(1.75);
  margin-bottom: s(small);
  min-width: 100%;
  padding: 0 rem(20) rem(1);
  position: fixed;
  right: 0;
  text-transform: uppercase;
  top: 0;
  width: 100%;

  .filter-dropdown--combo & {
    @include u-visually-hidden;
  }

  @include mq(768px) {
    @include u-visually-hidden;
  }
}

.filter-dropdown__wrapper {
  background: c(white);
  box-shadow: 0 0 rem(8) 0 rgba(c(black), 0.25);
  display: none;
  height: 100%;
  left: rem(-1);
  margin: 0;
  overflow-y: scroll;
  padding: ($filter-dropdown__modal-heading-height + rem(20)) rem(12) 0 rem(6);
  position: fixed;
  right: rem(-1);
  top: 0;
  z-index: z(primary filter);

  @include mq(768px) {
    height: auto;
    max-height: rem(560);
    max-width: rem(418); // Temp fix, as this filter will be reworked
    min-width: rem(418);
    padding: rem(20) rem(12) 0;
    position: absolute;
    top: rem(43); // TODO: Refactor so the top always starts beneath the dropdown-button
    width: 100%;
  }

  &.is-open,
  &.is-expanded {
    display: block;
  }

  .filter--center & {
    @include mq(768px) {
      left: -50%;
    }
  }

  .filter-dropdown--team & {
    @include mq(768px) {
      left: auto;
      right: 0;
    }

    @include mq(1280px) {
      left: 0;
      right: auto;
    }
  }

  .filter-round-wrapper & {
    left: 0;
    padding-left: rem(4);
    padding-right: rem(4);
  }

  .filter-dropdown--combo & {
    height: auto;
    min-width: 0;
    padding: rem(12);
    position: absolute;
    top: rem(43);
  }
}

.filter-dropdown__wrapper--groups-2 {
  max-width: none;

  @include mq(768px) {
    width: rem(768);
  }

  @media (min-width: em(960px)) and (max-width: em(1020px)) {
    width: rem(768) - (s(small) + s(medium));
  }

  @include mq(1100px) {
    width: rem(840);
  }

  &.is-open,
  &.is-expanded {
    display: flex;
    flex-wrap: wrap;
  }
}

.filter-dropdown__options-wrapper {
  .browser-ios & {
    height: 100%;
    overflow-y: scroll;
  }

  .filter-dropdown__wrapper--groups-1 & {
    @include mq(768px) {
      margin-bottom: s(medium);
    }
  }

  .filter-dropdown__wrapper--groups-2 & {
    @include mq(600px) {
      margin-bottom: s(medium);
      width: 50%;
    }
  }

  .filter-dropdown__wrapper--groups-2 &:not(:first-of-type) {
    margin-top: s(medium);

    @include mq(600px) {
      margin-top: 0;
    }
  }
}

.filter-dropdown__options {
  color: c(gray 222222);
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  margin: 0;
  padding: 0 s(x-small);
  width: 100%;

  @include mq(768px) {
    padding: 0;
  }

  .filter-dropdown--combo & {
    padding: 0;
  }
}

.filter-dropdown__options--team,
.filter-dropdown__options--topic {
  justify-content: flex-start;
}

.filter-dropdown-item {
  border-color: inherit;
  display: block;
  padding: 0 0 rem(4);
  width: 100%;

  &.filter-dropdown-item--pill {
    padding: 0 s(x-small) s(small);
    width: auto;
  }

  &.filter-dropdown-item--team {
    padding: 0 s(x-small) rem(10);
  }

  .filter-dropdown--combo & {
    padding: 0;
  }
}

.filter-dropdown-item--row {
  .filter-dropdown__options & {
    &:last-child {
      margin-bottom: s(small);
    }
  }
}

.filter-dropdown-item--team {
  width: 50%;
}

.filter-dropdown-item--topic {
  @include mq(400px) {
    width: 50%;
  }
}

.filter-dropdown-button {
  background: transparent;
  border: none;
  font-size: fs(14);
  letter-spacing: rem(1);
  overflow: hidden;
  padding: rem(15) rem(11) rem(13);
  text-align: left;
  text-transform: uppercase;
  width: 100%;

  @include mq(768px) {
    border-bottom: none;
    display: inline-block;
  }

  .filter__wrapper--on-dark & {
    color: c(white);
  }

  .filter__wrapper--compact & {
    @include media-query(768, max-width) {
      font-size: fs(12);
    }
  }
}

.filter-dropdown-button__content {
  align-items: center;
  display: flex;
  justify-content: space-between;
}

.filter-dropdown-button__value {

  @include mq(768px) {
    padding: 0 rem(44) 0 rem(6);
  }

  .filter-dropdown--combo &,
  .filter--center & {
    padding: 0 s(small) 0 rem(2);
  }

  .filter__wrapper--compact & {
    padding-right: s(xx-small);

    @include mq(768) {
      padding-right: s(x-small);
    }
  }
}

.filter-dropdown-button__combo-label {
  color: c(gray 767676);
  font-weight: fw(400);
  letter-spacing: 0;
  margin-right: rem(14);
  text-transform: none;
}

.filter-dropdown-button__combo-value-spacer {
  display: block;
  height: 0;
  visibility: hidden;
}

.filter-dropdown-button__chevron {
  fill: c(gray 222222);
  height: rem(14);
  transition: transform 0.4s ease;
  width: rem(14);

  .filter-dropdown--combo & {
    height: rem(10);
    width: rem(10);
  }

  .filter__wrapper--compact & {
    height: rem(8);
    width: rem(8);
  }

  .filter__wrapper--on-dark & {
    fill: c(white);
  }
}

.filter-dropdown__close {
  background: none;
  border: none;
  height: rem(18);
  padding: 0;
  position: fixed;
  right: rem(20);
  top: rem(13);
  width: rem(18);

  .filter-dropdown--combo & {
    display: none;
  }

  @include mq(768px) {
    display: none;
  }
}

.filter-dropdown__close-svg {
  fill: c(white);
  height: rem(18);
  width: rem(18);
}

.filter-dropdown-option {
  align-items: center;
  background: transparent;
  border: rem(2) solid transparent;
  color: inherit;
  display: flex;
  font-size: fs(14);
  margin: 0;
  padding: rem(6);
  text-align: left;
  width: 100%;

  &:focus,
  &:hover {
    border-color: inherit if($important, !important, null);
    border-width: rem(2) if($important, !important, null);
    color: c(black);
  }

  &.is-selected {
    border-color: c(black) if($important, !important, null);
    border-width: rem(2) if($important, !important, null);
  }

  .filter-dropdown--combo & {
    border-width: rem(2);
    padding: rem(12) rem(13);
  }

  .filter-dropdown-item--pill & {
    border-color: c(gray efefef);
    border-radius: rem(2);
    border-width: rem(1);
    justify-content: center;
    min-height: rem(48);
    min-width: rem(100);
    text-align: center;

    @include mq(768px) {
      min-width: rem(108);
    }

    .browser-ie & {
      height: 100%; // ie flex fix
    }
  }

  .filter-dropdown-item--team & {
    padding: rem(2);
  }

  .filter-dropdown-item--topic & {
    letter-spacing: rem(0.85);
    padding: rem(6) s(small) rem(6) s(x-small);
    text-transform: uppercase;
  }
}

.filter-dropdown-option__svg {
  flex-shrink: 0;
  height: rem(35);
  margin-right: rem(4);
  width: rem(35);

  .filter-dropdown-item--team & {
    margin-right: rem(6);
  }
}

.filter-dropdown-option__text {
  align-self: center;
  display: flex;
  font-size: fs(16);
  letter-spacing: rem(1);

  @include mq(768px) {
    font-size: fs(14);
  }

  .filter-dropdown-item--pill & {
    flex-grow: 1;
    justify-content: center;
  }

  .filter-dropdown-item--combo &,
  .filter-dropdown-item--team & {
    font-size: fs(14);
  }

  .filter-dropdown__options--topic & {
    font-size: fs(12);
  }
}
